# ENCLOSE - ENhancing social understanding: statistical matching for CompLex sOcial SurvEy

Social scientists now have unprecedented access to large-scale, cross-national, repeated cross-sectional survey data for investigating the complex interaction of social, psychological, and biological factors that shape individual and societal trajectories. In this framework, the capacity to conveniently integrate insights from multiple datasets enhances social scientists' analytical capabilities. However, the current framework lacks integration of multiple sources, hindering the development of in-depth analyses. To address this gap, ENCLOSE aims to provide methodological advancements and software tools for integrating data from different social surveys conducted simultaneously and to construct pseudo-panels given repeated cross-sectional surveys. By leveraging statistical matching techniques, ENCLOSE facilitates the combination of data from distinct sources, enabling researchers to establish meaningful connections and gain deeper insights into complex social phenomena. However, integrating social surveys presents challenges such as data heterogeneity, complex survey designs, selection of common matching variables, and handling composite scores. To overcome these challenges, ENCLOSE will develop advanced statistical tools and methodologies. Ultimately, ENCLOSE seeks to enhance the compatibility, consistency, and analytical capabilities of integrated social survey datasets, thereby contributing to advancements in social science research.
 
 ## PE GRINS - GRINS - GROWING RESILIENT, INCLUSIVE AND SUSTAINABLE
This project is part of Program GRINS

![GRINS](./media/logos_banner.png)

_Programma PE GRINS - GRINS - GROWING RESILIENT, INCLUSIVE AND SUSTAINABLE” (cod.
PE0000018 CUP: J33C22002910001). Avviso 341/2022 “Partenariati estesi alle università, ai centri di ricerca, alle aziende per il finanziamento di progetti di ricerca di base”. Piano Nazionale di Ripresa e Resilienza, Missione 4 “Istruzione e ricerca” – Componente 2 “Dalla ricerca all’impresa” – Investimento 1.3, finanziato dall’Unione europea – NextGenerationEU – Bando a Cascata SPOKE 0 E 2_

# This Repository

This repository contains the code developed for Deliverables 3.1 and 3.2 of the project.
Due to licensing restrictions, we are unable to provide the intermediate and final outputs generated by the code, as some of the datasets used in the analysis are subject to usage limitations.

However, the input datasets are freely available under the conditions specified by their respective providers. End users can therefore obtain these datasets independently and apply the workflows contained in this repository to reproduce the analysis and generate the final outputs.

The codes provided in this repository are licensed under Creative Commons Attribution 4.0. [![License: CC BY 4.0](https://img.shields.io/badge/License-CC_BY_4.0-lightgrey.svg)](https://creativecommons.org/licenses/by/4.0/).

The codes are R Markdown Files that can be executed using the R enviroment. One of the files exploit _Rmidas_ library, that requires also Python enviroment installed.

## The input datasets

 - _ZA7649_v2-1-0.sav_ - Eurobarometer 93.1 (2020) - This dataset is *NOT* included in the repository. It has been provided by [European Social Survey](https://europeansocialsurvey.org/). It is licenced under the terms at this page[https://www.gesis.org/en/institute/data-usage-terms].
 The dataset can be downloaded at the followin URL: https://search.gesis.org/research_data/ZA7649

  - _EES9.sav_ - ESS9 - integrated file, edition 3.2 - This dataset is included in the [repository](./datasets/ESS9.sav). It has been provided by [European Social Survey](https://europeansocialsurvey.org/). It is licenced under [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/). The dataset can be downloaded at the following URL: https://ess.sikt.no/en/datafile/b2b0bf39-176b-4eca-8d26-3c05ea83d2cb

  - _EES10.sav_ - ESS10 - integrated file, edition 3.2 This dataset is included in the [repository](./datasets/ESS10.sav). It has been provided by [European Social Survey](https://europeansocialsurvey.org/). It is licenced under [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/). The dataset can be downloaded at the following URL: https://ess.sikt.no/en/datafile/f37d014a-6958-42d4-b03b-17c29e481d3d


  - _EES11.sav_ - ESS11 - integrated file, edition 3.0 - This dataset is included in the [repository](./datasets/ESS11.sav). It has been provided by [European Social Survey](https://europeansocialsurvey.org/). It is licenced under [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/). The dataset can be downloaded at the following URL: https://ess.sikt.no/en/datafile/242aaa39-3bbb-40f5-98bf-bfb1ce53d8ef

## Deliverable 3.1

This deliverable investigates European attitudes toward immigration by combining data from the European Social Survey (ESS) and the Eurobarometer to build a harmonized, multilevel dataset for comparative analysis. The activities carried out include an empirical exploration of immigration attitudes across countries, identifying cross-national differences and socio-political dynamics.

Advanced multilevel Item Response Theory (IRT) models were applied to estimate latent traits such as trust in institutions, immigration rejection, and perceived benefits of immigration, while accounting for clustering at the national level. A crucial step was the harmonization of data, aligning socio-demographic variables (age, gender, occupation, domicile, political orientation) and ensuring comparability of latent constructs across the two surveys.

To address missing information, several statistical matching (SM) techniques were implemented. These included nonparametric nearest-neighbor methods, parametric approaches such as Fully Conditional Specification and Joint Modelling, as well as a Bayesian hierarchical framework designed to integrate multilevel data. Additionally, deep learning methods (rMIDAS) were explored, leveraging neural networks for flexible and scalable imputations.

The evaluation of these methods demonstrated the importance of considering multilevel structures and latent dependencies to generate reliable imputations. Overall, the integration of ESS and Eurobarometer enables the reconstruction of nuanced attitudinal patterns, enriching comparative research on immigration across European populations.

For more details read the [Full Report](./reports/deliverable_3_1.pdf).

### Provided files
```
📦deliverable_3_1_codes
 ┣ 📂workflow_4_1_non_parametric_statistical_matching
 ┃ ┣ 📜ENCLOSE_analysis_mice_mitml_imputation_clean.Rmd
 ┃ ┣ 📜ENCLOSE_common_variable_comparison_distances_clean.Rmd
 ┃ ┣ 📜ENCLOSE_data_harmonization_clean.Rmd
 ┃ ┣ 📜ENCLOSE_distances_mice_mitml_imputation_clean.Rmd
 ┃ ┣ 📜ENCLOSE_mice_mitml_imputation_multilevel_clean.Rmd
 ┃ ┣ 📜ENCLOSE_regression_on_common_variables_clean.Rmd
 ┃ ┣ 📜workflow.html
 ┃ ┣ 📜workflow.pdf
 ┃ ┗ 📜workflow.Rmd
 ┣ 📂workflow_4_2_parametric_statistical_matching
 ┃ ┣ 📜ENCLOSE_data_harmonization_clean.Rmd
 ┃ ┣ 📜hotdeck_imputation_updated.Rmd
 ┃ ┣ 📜workflow.html
 ┃ ┣ 📜workflow.pdf
 ┃ ┗ 📜workflow.Rmd
 ┗ 📂workflow_4_5_deep_learning
 ┃ ┣ 📜Midas_corr_reg.Rmd
 ┃ ┣ 📜Midas_distances.Rmd
 ┃ ┣ 📜Midas_imputations.Rmd
 ┃ ┣ 📜workflow.html
 ┃ ┣ 📜workflow.pdf
 ┃ ┗ 📜workflow.Rmd
```

### Workflow for execution

For a description of the aim of the R Markdown files and the workflows to attend to get the final outputs based on the different approches implemented and described in in the Deliverable 3.1 report, you can check the respective workflow explaination files: 

- [Non parametric Statistical Matching (Deliverable Report sect. 4.1)](./deliverable_3_1_codes/workflow_4_1_non_parametric_statistical_matching/workflow.pdf)
- [Parametric Statistical Matching (Deliverable Report sect. 4.2)](./deliverable_3_1_codes/workflow_4_2_parametric_statistical_matching/workflow.pdf)
- [Deep Learning (Deliverable Report sect. 4.5)](./deliverable_3_1_codes/workflow_4_5_deep_learning/workflow.pdf)

## Deliverable 3.2

The study analyzes changes in Trust in Institutions and Satisfaction with Country Conditions in Europe before and after COVID-19, using data from ESS Wave 9 (2018), ESS Wave 11 (2023), and the Eurobarometer (2023) within a pseudo-panel framework. The process begins with the identification of common countries and the harmonization of sociodemographic, political, and attitudinal indicators, followed by the estimation of latent constructs through confirmatory factor analysis, including Interpersonal Trust, Political Participation, and Human Values. The main outcomes are the latent variables Trust in Institutions and Satisfaction with Country Conditions.

To construct the pseudo-panel, the dependence of target variables on covariates was assessed to check confounding, and multiple statistical matching methods were applied:

- Propensity Score Matching (PSM) with nearest-neighbour and full optimal matching.

- Hot-Deck Matching using Gower’s similarity coefficient for mixed-type variables.

- Predictive Mean Matching (PMM) within a multiple imputation framework.

Shifts in latent outcomes were then estimated by regressing differences between observed and imputed baseline values, applying linear models, g-computation, and pooling across imputations.

Findings reveal heterogeneous country-level trends. Trust in Institutions increased in Bulgaria, Spain, Finland, Ireland, Italy, Lithuania, Montenegro, Portugal, Slovenia, and Slovakia, but declined in Austria, Great Britain, Hungary, the Netherlands, and Poland. Satisfaction with Country Conditions decreased most sharply in Austria, Belgium, Germany, Finland, Great Britain, Hungary, the Netherlands, Norway, and Portugal, but rose in Croatia and Ireland. Countries such as Cyprus, Latvia, and Serbia showed no significant changes. The convergence of results across methods confirms the robustness of these patterns and demonstrates the value of integrating parametric and nonparametric matching techniques for retrospective longitudinal analysis.

For more details read the [Full Report](./reports/deliverable_3_2.pdf).

### Repository files
```
📦deliverable_3_2_codes
 ┣ 📜ENCLOSE_harmonization_panel_clean.Rmd
 ┣ 📜ENCLOSE_Latent_traits_estimation_configural_clean.Rmd
 ┣ 📜ENCLOSE_pseudo_panel_hotdeck_clean.Rmd
 ┣ 📜ENCLOSE_pseudo_panel_pmm_clean.Rmd
 ┣ 📜ENCLOSE_pseudo_panel_psm_full_clean.Rmd
 ┣ 📜ENCLOSE_pseudo_panel_psm_nn_clean.Rmd
 ┣ 📜ENCLOSE_pseudo_panel_psm_optimal_clean.Rmd
 ┣ 📜workflow.html
 ┣ 📜workflow.pdf
 ┗ 📜workflow.Rmd
```

### Workflow for execution

For a description of the aim of the R Markdown files and the workflow to attend to get the final output, check the [workflow file explaination](./deliverable_3_2_codes/workflow.pdf).